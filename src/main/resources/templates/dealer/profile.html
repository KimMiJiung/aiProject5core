<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìë™ì°¨ ë”œëŸ¬ CRM</title>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      display: flex;
      height: 100vh;
      background: #f3f5f9;
      color: #1f2933;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    /* ì»¬ëŸ¬ í† í° ëŠë‚Œ */
    :root {
      --primary: #0d47a1;
      --primary-soft: #e3eefc;
      --bg-elevated: #ffffff;
      --border-subtle: #e2e8f0;
      --text-muted: #6b7280;
      --danger: #e53935;
      --success: #1aa36f;
      --warning: #f59e0b;
    }

    /* ë ˆì´ì•„ì›ƒ */
    .sidebar {
      width: 248px;
      background: linear-gradient(180deg, #0d47a1 0%, #093272 100%);
      color: #ffffff;
      display: flex;
      flex-direction: column;
      padding: 20px 0;
    }

    .sidebar__logo {
      padding: 0 24px 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.14);
      margin-bottom: 16px;
    }

    .sidebar__logo-title {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    .sidebar__section-title {
      font-size: 12px;
      text-transform: uppercase;
      opacity: 0.75;
      padding: 0 24px;
      margin-bottom: 6px;
    }

    .menu-list {
      list-style: none;
      padding: 0 8px;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 16px;
      margin: 2px 8px;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.18s ease, transform 0.12s ease;
      color: #eef3ff;
      opacity: 0.9;
    }

    .menu-item:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-1px);
      opacity: 1;
    }

    .menu-item--active {
      background: #ffffff;
      color: #0d47a1;
      opacity: 1;
      font-weight: 600;
    }

    .menu-item__bullet {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.6);
    }

    .menu-item--active .menu-item__bullet {
      background: #0d47a1;
    }

    .sidebar__bottom {
      margin-top: auto;
      padding: 12px 24px 8px;
      font-size: 12px;
      opacity: 0.7;
    }

    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-width: 0;
    }

    .header {
      height: 64px;
      background: #ffffff;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 24px;
      border-bottom: 1px solid #e5e7eb;
    }

    .header__left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo {
      font-size: 18px;
      font-weight: 700;
      color: #0d47a1;
    }

    .header__chip {
      padding: 4px 10px;
      border-radius: 999px;
      background: #e3eefc;
      font-size: 11px;
      color: #1f3e7a;
    }

    .user-info {
      font-size: 14px;
      color: #374151;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .user-info__role {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      background: #f3f4f6;
      color: #6b7280;
    }

    .user-info span.logout {
      color: #0d47a1;
      cursor: pointer;
      font-weight: 600;
    }

    .content {
      padding: 20px 24px 24px;
      overflow-y: auto;
    }

    .content__row {
      display: flex;
      gap: 24px;
      align-items: flex-start;
    }

    /* ì¹´ë“œ ê³µí†µ */
    .card {
      background: var(--bg-elevated);
      padding: 18px 18px 16px;
      border-radius: 14px;
      box-shadow: 0 4px 10px rgba(15, 23, 42, 0.06);
      border: 1px solid var(--border-subtle);
    }

    .card__header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .card__title {
      font-size: 15px;
      font-weight: 600;
      color: #1f2937;
    }

    .card__subtitle {
      font-size: 12px;
      color: var(--text-muted);
    }

    .card__chip {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      background: #f3f4f6;
      color: #6b7280;
    }

    /* ë”œëŸ¬ ì˜ì—­ */
    .dealer-panel {
      width: 32%;
      min-width: 280px;
      display: flex;
      flex-direction: column;
      gap: 14px;
      margin-top: 8px;
    }

    .dealer-profile {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .dealer-profile__top {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .dealer-avatar {
      width: 70px;
      height: 70px;
      border-radius: 999px;
      background: linear-gradient(135deg, #1e40af, #0ea5e9);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #ffffff;
      font-weight: 700;
      font-size: 20px;
    }

    .dealer-profile__name {
      font-size: 18px;
      color: #0d47a1;
      margin-bottom: 4px;
      font-weight: 700;
    }

    .dealer-profile__meta {
      font-size: 13px;
      color: var(--text-muted);
      line-height: 1.5;
    }

    .dealer-profile__meta strong {
      color: #4b5563;
      font-weight: 600;
    }

    .dealer-profile__divider {
      height: 1px;
      background: #e5e7eb;
      margin: 2px 0 8px;
    }

    .dealer-contact {
      font-size: 13px;
      color: #374151;
      display: grid;
      row-gap: 4px;
    }

    .dealer-contact__label {
      color: var(--text-muted);
      width: 46px;
      display: inline-block;
    }

    .dealer-status-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 4px;
    }

    .dealer-status-tag {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      background: #ecfdf3;
      color: var(--success);
      border: 1px solid rgba(16, 185, 129, 0.2);
    }

    .dealer-status-text {
      font-size: 11px;
      color: var(--text-muted);
    }

    /* KPI */
    .kpi-box {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      margin-top: 6px;
    }

    .kpi-item {
      background: var(--primary-soft);
      padding: 10px 10px;
      border-radius: 10px;
      text-align: left;
      color: var(--primary);
      font-weight: 600;
      font-size: 14px;
    }

    .kpi-item__label {
      font-size: 11px;
      font-weight: 500;
      opacity: 0.8;
      margin-bottom: 4px;
    }

    .kpi-item__value {
      font-size: 16px;
    }

    .kpi-item__trend {
      font-size: 11px;
      margin-top: 2px;
      color: var(--success);
    }

    .kpi-item__trend--down {
      color: var(--danger);
    }

    /* ì°¨íŠ¸ ì¹´ë“œ */
    .chart-card {
      margin-top: 6px;
    }

    .chart-card canvas {
      width: 100%;
      max-width: 100%;
    }

    /* ì˜¤ë¥¸ìª½ ë©”ì¸ ì˜ì—­ */
    .main-panel {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .main-panel__header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }

    .page-title {
      font-size: 18px;
      font-weight: 700;
      color: #111827;
    }

    .page-subtitle {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 2px;
    }

    .filter-group {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .filter-pill {
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      background: #ffffff;
      cursor: pointer;
      transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease;
    }

    .filter-pill--active {
      background: #0d47a1;
      color: #ffffff;
      border-color: #0d47a1;
      font-weight: 500;
    }

    /* ê³ ê° ë¦¬ìŠ¤íŠ¸ */
    .customer-section {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .customer-list-wrapper {
      max-height: 280px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .customer-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }

    .customer-table thead {
      position: sticky;
      top: 0;
      background: #f9fafb;
      z-index: 1;
    }

    .customer-table th,
    .customer-table td {
      padding: 8px 10px;
      text-align: left;
      border-bottom: 1px solid #edf2f7;
      white-space: nowrap;
    }

    .customer-table th {
      font-size: 12px;
      color: #6b7280;
      font-weight: 600;
    }

    .customer-row {
      transition: background 0.12s ease;
      cursor: pointer;
    }

    .customer-row:hover {
      background: #f3f4ff;
    }

    .customer-name-cell {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .customer-avatar {
      width: 28px;
      height: 28px;
      border-radius: 999px;
      background: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      color: #4b5563;
      font-weight: 600;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 500;
    }

    .badge--vip {
      background: #fef3c7;
      color: #92400e;
    }

    .badge--lead {
      background: #ecfdf3;
      color: #166534;
    }

    .badge--pending {
      background: #fef2f2;
      color: #b91c1c;
    }

    .customer-tag {
      font-size: 11px;
      color: #6b7280;
    }

    /* ì—…ë¬´ ìš”ì•½ ì¹´ë“œ */
    .summary-list {
      display: grid;
      row-gap: 4px;
      margin-top: 2px;
    }

    .summary-item {
      display: flex;
      justify-content: space-between;
      font-size: 13px;
      color: #374151;
    }

    .summary-item__label {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .summary-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #0d47a1;
    }

    .summary-dot--warning {
      background: var(--warning);
    }

    .summary-dot--danger {
      background: var(--danger);
    }

    .summary-item__value {
      font-weight: 600;
    }

    /* ì›”ê°„ íŒë§¤ ì°¨íŠ¸ */
    .monthly-card {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .monthly-card__meta {
      font-size: 11px;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
    }

    .legend {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 11px;
    }

    .legend-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: #0d47a1;
    }

    .legend-dot--secondary {
      background: #22c55e;
    }

    /* ìŠ¤í¬ë¡¤ë°” ì»¤ìŠ¤í„°ë§ˆì´ì§• (ì˜µì…˜) */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-thumb {
      background: #cbd5f5;
      border-radius: 999px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }
	
	/* ë‹¬ë ¥ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
	   .calendar-container {
	     height: 600px;
	     overflow-y: auto;
	     padding: 12px;
	     background: #fafbfc;
	     border-radius: 8px;
	   }

	   .calendar-header {
	     display: flex;
	     justify-content: space-between;
	     align-items: center;
	     margin-bottom: 16px;
	     padding-bottom: 12px;
	     border-bottom: 1px solid #e5e7eb;
	   }

	   .calendar-title {
	     font-size: 15px;
	     font-weight: 600;
	     color: #1f2937;
	   }

	   .calendar-nav {
	     display: flex;
	     gap: 8px;
	   }

	   .calendar-nav-btn {
	     width: 32px;
	     height: 32px;
	     border: 1px solid #d1d5db;
	     background: #ffffff;
	     border-radius: 6px;
	     cursor: pointer;
	     display: flex;
	     align-items: center;
	     justify-content: center;
	     font-size: 14px;
	     color: #374151;
	     transition: all 0.15s ease;
	   }

	   .calendar-nav-btn:hover {
	     background: #f3f4f6;
	     border-color: #0d47a1;
	     color: #0d47a1;
	   }

	   .calendar-nav-btn.disabled {
	     opacity: 0.4;
	     cursor: not-allowed;
	   }

	   .calendar-grid {
	     display: grid;
	     grid-template-columns: repeat(7, 1fr);
	     gap: 4px;
	     font-size: 12px;
	   }

	   .calendar-day-header {
	     text-align: center;
	     font-weight: 600;
	     color: #6b7280;
	     padding: 8px 4px;
	     background: #f8fafc;
	     border-radius: 6px;
	   }

	   .calendar-day {
	     aspect-ratio: 1;
	     display: flex;
	     flex-direction: column;
	     padding: 6px 4px;
	     border-radius: 6px;
	     cursor: pointer;
	     transition: all 0.15s ease;
	     border: 1px solid transparent;
	     position: relative;
	     min-height: 60px;
	   }

	   .calendar-day:hover {
	     background: #f3f4ff;
	     border-color: #cbd5e1;
	   }

	   .calendar-day.today {
	     background: linear-gradient(135deg, #0d47a1, #1e40af);
	     color: white;
	   }

	   .calendar-day.other-month {
	     color: #d1d5db;
	     background: transparent;
	   }

	   .calendar-day-number {
	     font-weight: 600;
	     font-size: 13px;
	     margin-bottom: 4px;
	   }

	   .calendar-day.today .calendar-day-number {
	     color: white;
	   }

	   .calendar-events {
	     display: flex;
	     flex-direction: column;
	     gap: 2px;
	     flex: 1;
	     min-height: 0;
	   }

	   .calendar-event {
	     font-size: 10px;
	     padding: 2px 4px;
	     border-radius: 4px;
	     overflow: hidden;
	     text-overflow: ellipsis;
	     white-space: nowrap;
	     font-weight: 500;
	   }

	   .calendar-event.progress {
		background: #bbf7d0;
		color: #166534;
	   }

	   .calendar-event.completed {
		background: #fef3c7;
		  color: #92400e;
	   }

	   .calendar-event.empty {
	     color: #9ca3af;
	     font-style: italic;
	   }

	   .no-events {
	     color: #9ca3af;
	     font-size: 11px;
	     text-align: center;
	     padding-top: 8px;
	   }
	   /* ë©”ì‹ ì € & ì•Œë¦¼ í¼ & AI ì±—ë´‡ ë·° */
	   .messaging-section, .notice-form-section, .ai-consult-form-section, .notice-list-section { 
	     display: flex;
	     flex-direction: column;
	     gap: 10px;
	   }

	   /* í¼ ìš”ì†Œ ê¸°ë³¸ ìŠ¤íƒ€ì¼ í†µì¼ ë° ê°œì„  */
	   .message-input-group input, 
	   .message-input-group button, 
	   .notice-form-section input, 
	   .notice-form-section textarea,
	   .form-group select {
	     padding: 10px 12px; 
	     border-radius: 10px; 
	     border: 1px solid var(--border-subtle); 
	     font-size: 14px;
	     transition: border-color 0.2s ease, box-shadow 0.2s ease;
	     width: 100%; /* ë„ˆë¹„ 100%ë¡œ ì„¤ì •í•˜ì—¬ í¼ ê·¸ë£¹ ë‚´ì—ì„œ ê°€ë“ ì°¨ë„ë¡ í•¨ */
	   }

	   /* í¬ì»¤ìŠ¤ ì‹œ ê°•ì¡° */
	   .notice-form-section input:focus, 
	   .notice-form-section textarea:focus,
	   .form-group select:focus,
	   .message-input-group input:focus {
	       outline: none;
	       border-color: var(--primary); 
	       box-shadow: 0 0 0 3px var(--primary-soft); 
	   }
	   
	   /* ì•Œë¦¼ í¼ */
	   .notice-form {
	     display: flex;
	     flex-direction: column;
	     gap: 16px; 
	     margin-top: 8px; 
	   }
	   
	   /* --- ê³µì§€ì‚¬í•­ ë¦¬ìŠ¤íŠ¸ ì„¹ì…˜ ìŠ¤íƒ€ì¼ (NEW) --- */
	   .notice-list-section {
	       flex: 1; /* ë©”ì‹ ì €ì™€ ê°™ì€ ë„ˆë¹„ë¥¼ ê°–ë„ë¡ ì„¤ì • */
	   }
	   
	   .notice-list {
	       display: flex;
	       flex-direction: column;
	       gap: 10px;
	       max-height: 300px; /* ë¦¬ìŠ¤íŠ¸ ë†’ì´ ì œí•œ */
	       overflow-y: auto;
	   }

	   .notice-item {
	       display: flex;
	       justify-content: space-between;
	       align-items: center;
	       padding: 10px 14px;
	       border-radius: 8px;
	       background: #f8f9fa;
	       border: 1px solid #e9ecef;
	       transition: background 0.2s ease;
	       cursor: pointer;
	   }

	   .notice-item:hover {
	       background: #e3eefc;
	   }

	   .notice-item__content {
	       flex-grow: 1;
	       min-width: 0;
	       padding-right: 15px;
	   }

	   .notice-item__title {
	       font-size: 14px;
	       font-weight: 600;
	       color: #1f2937;
	       white-space: nowrap;
	       overflow: hidden;
	       text-overflow: ellipsis;
	   }

	   .notice-item__meta {
	       font-size: 11px;
	       color: var(--text-muted);
	       margin-top: 2px;
	   }

	   .notice-item__target {
	       font-size: 11px;
	       font-weight: 600;
	       padding: 3px 8px;
	       border-radius: 999px;
	       background: var(--primary-soft);
	       color: var(--primary);
	       min-width: 60px;
	       text-align: center;
	   }

    @media (max-width: 960px) {
      body {
        flex-direction: column;
      }
      .sidebar {
        width: 100%;
        flex-direction: row;
        align-items: center;
        height: 56px;
      }
      .sidebar__logo {
        border-bottom: none;
        margin-bottom: 0;
      }
      .sidebar__section-title,
      .sidebar__bottom {
        display: none;
      }
      .menu-list {
        display: flex;
        flex: 1;
        justify-content: flex-end;
        padding-right: 16px;
      }
      .menu-item {
        margin: 0 4px;
        padding: 6px 10px;
      }
      .main {
        height: calc(100vh - 56px);
      }
      .content__row {
        flex-direction: column;
      }
      .dealer-panel {
        width: 100%;
        flex-direction: row;
      }
	  .calendar-day {
	    min-height: 48px;
	    padding: 4px 2px;
	  }

	  .calendar-day-number {
	    font-size: 12px;
	  }

	  .calendar-event {
	    font-size: 9px;
	  }
    }
  </style>
</head>
<body>

  <div class="sidebar">
    <div class="sidebar__logo">
      <div class="sidebar__logo-title">ê´€ë¦¬ ë©”ë‰´</div>
    </div>
    <div class="sidebar__section-title">Navigation</div>
    <ul class="menu-list">
	  <li>
	    <a th:href="@{/main}" class="menu-item">
	      <span class="menu-item__bullet"></span>
	      <span>ë©”ì¸ ëŒ€ì‹œë³´ë“œ</span>
	    </a>
	  </li>
      <li>
        <a th:href="@{/dealer}" class="menu-item menu-item--active">
          <span class="menu-item__bullet"></span>
          <span>ë”œëŸ¬ í”„ë¡œí•„</span>
        </a>
      </li>
      <li>
        <a th:href="@{/dealer/care}" class="menu-item">
          <span class="menu-item__bullet"></span>
          <span>ìƒë‹´ ì‹ ì²­ ëª…ë‹¨</span>
        </a>
      </li>
      <li>
        <a th:href="@{/dealer/myCustomer}" class="menu-item">
          <span class="menu-item__bullet"></span>
          <span>ìƒë‹´ ê´€ë¦¬</span>
        </a>
      </li>
      <li>
        <a th:href="@{/dealer/sale}" class="menu-item">
          <span class="menu-item__bullet"></span>
          <span>êµ¬ë§¤ ê´€ë¦¬</span>
        </a>
      </li>
    </ul>
    <div class="sidebar__bottom">
      HYUNDAI CRM Â· Dealer Console
    </div>
  </div>

  <div class="main">
    <div class="header">
      <div class="header__left">
        <div class="logo">HYUNDAI CRM</div>
        <div class="header__chip">Dealer Dashboard</div>
      </div>
      <div class="user-info">
        <span class="user-info__role">ë‹´ë‹¹ ë”œëŸ¬</span>
        <span>[[${#authentication.getPrincipal().getUsername()}]] ë‹˜</span>
        <span class="logout"><a sec:authorize="isAuthenticated()" th:href="@{/logout}" class="nav-link">ë¡œê·¸ì•„ì›ƒ</a></span>
      </div>
    </div>

    <div class="content">
      <div class="content__row">

        <!-- ë”œëŸ¬ íŒ¨ë„ -->
        <aside class="dealer-panel">
          <section class="card dealer-profile">
            <div class="card__header">
              <div>
                <h3 class="card__title">ë”œëŸ¬ ì •ë³´</h3>
                <p class="card__subtitle">ê¸°ë³¸ í”„ë¡œí•„ ë° ì—°ë½ì²˜</p>
              </div>
              <span class="card__chip">ì‹¤ì‹œê°„ ë™ê¸°í™”</span>
            </div>

            <div class="dealer-profile__top">
              <div class="dealer-avatar">
                <span>[[${#strings.substring(dealer.name,0,1)}]]</span>
              </div>
              <div>
                <div class="dealer-profile__name">[[${dealer.name}]]</div>
                <p class="dealer-profile__meta">
                  <strong>ì§ê¸‰</strong> [[${dealer.role}]]<br />
                  <strong>ê·¼ë¬´ì§€</strong> í˜„ëŒ€ìë™ì°¨ ì„œìš¸ì§€ì 
                </p>
              </div>
            </div>

            <div class="dealer-profile__divider"></div>

            <div class="dealer-contact">
              <div>
                <span class="dealer-contact__label">ì „í™”</span>
                <span>[[${dealer.phone}]]</span>
              </div>
              <div>
                <span class="dealer-contact__label">ì´ë©”ì¼</span>
                <span>[[${dealer.email}]]</span>
              </div>
            </div>

            <div class="dealer-status-row">
              <span class="dealer-status-tag">ì˜¨ë¼ì¸ â€¢ ìƒë‹´ ê°€ëŠ¥</span>
              <span class="dealer-status-text">ìµœê·¼ í™œë™: 5ë¶„ ì „</span>
            </div>
          </section>
		  
		    <section class="card notice-list-section" style="flex:1;">
		        <div class="card__header">
		          <h3 class="card__title">ê³µì§€ì‚¬í•­ ëª©ë¡</h3>
		          <span class="card__subtitle">ì´ [[${noticePage.totalElements}]]ê±´ì˜ ê³µì§€/ì•Œë¦¼ ë‚´ì—­ì…ë‹ˆë‹¤.</span>
		        </div>
		        
		      <div class="notice-list">
		        <div th:each="notice : ${notices}" class="notice-item" 
		          th:classappend="${notice.isImportant ? 'important-notice-item' : ''}"
		          th:style="${notice.isImportant ? 'border-left: 4px solid var(--warning);' : ''}"
		          >
		          <div class="notice-item__content">
		            <span class="notice-item__title" th:text="${notice.isImportant ? 'â­ ' + notice.title : notice.title}">ê³µì§€ì‚¬í•­ ì œëª©</span>
		            <span class="notice-item__meta">
		              ë“±ë¡ì¼: <span th:text="${notice.createDate}"></span> 
		              | ë“±ë¡ì: <span th:text="${notice.createName}">ê´€ë¦¬ì</span>
		            </span>
		          </div>
		          <span class="notice-item__target" 
		            th:text="${notice.target}"
		            th:style="${notice.isImportant ? 'background: #fef3c7; color: #b45309;' : ''}"
		            >ì „ì²´ ë”œëŸ¬</span>
		        </div>
		        <div th:if="${notices.isEmpty()}" style="text-align: center; color: var(--text-muted); padding: 20px;">
		           ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.
		        </div>
		      </div>
		        
		      <div th:if="${!noticePage.isEmpty()}" class="pagination-container" style="display: flex; justify-content: center; margin-top: 15px;">
		        <nav aria-label="Page navigation">
		          <ul class="pagination" style="list-style: none; display: flex; gap: 5px; padding: 0;">			                  
		  			<li th:class="${noticePage.first ? 'disabled' : ''}" style="display: inline-block;">
		                <a th:if="${!noticePage.first}" th:href="@{/admin/profile(page=${noticePage.number - 1})}" class="page-link" 
		                    style="padding: 6px 10px; border: 1px solid #ccc; border-radius: 5px; color: #0d47a1; text-decoration: none; font-size: 13px;">
		                     ì´ì „
		                </a>
		                <span th:if="${noticePage.first}" class="page-link disabled"
		                    style="padding: 6px 10px; border: 1px solid #ccc; border-radius: 5px; color: #6c757d; text-decoration: none; font-size: 13px; cursor: not-allowed;">
		                     ì´ì „
		                </span>
		              </li>	                  
		              <li th:each="i : ${#numbers.sequence(0, noticePage.totalPages - 1)}" 
		                th:class="${i == currentPage ? 'active' : ''}"
		                style="display: inline-block;">
		                <a th:if="${i == currentPage}" class="page-link active" 
		                   style="padding: 6px 10px; border: 1px solid #0d47a1; border-radius: 5px; background: #0d47a1; color: #fff; text-decoration: none; font-size: 13px; font-weight: bold;"
		                   th:text="${i + 1}"></a>
		                <a th:unless="${i == currentPage}" th:href="@{/admin/profile(page=${i})}" class="page-link" 
		                   style="padding: 6px 10px; border: 1px solid #ccc; border-radius: 5px; color: #0d47a1; text-decoration: none; font-size: 13px;"
		                   th:text="${i + 1}"></a>
		              </li>
		              
		  		  <li th:class="${noticePage.last ? 'disabled' : ''}" style="display: inline-block;">
		                  <a th:if="${!noticePage.last}" th:href="@{/admin/profile(page=${noticePage.number + 1})}" class="page-link"
		                    style="padding: 6px 10px; border: 1px solid #ccc; border-radius: 5px; color: #0d47a1; text-decoration: none; font-size: 13px;">
		                      ë‹¤ìŒ
		                  </a>
		                  <span th:if="${noticePage.last}" class="page-link disabled"
		                    style="padding: 6px 10px; border: 1px solid #ccc; border-radius: 5px; color: #6c757d; text-decoration: none; font-size: 13px; cursor: not-allowed;">
		                      ë‹¤ìŒ
		                  </span>
		               </li>
		         </ul>
		        </nav>
		    </div>
		  </section>

          <section class="card">
            <div class="card__header">
              <h3 class="card__title">ë‚˜ì˜ KPI</h3>
              <span class="card__subtitle"></span>
            </div>
            <div class="kpi-box">
              <div class="kpi-item">
                <div class="kpi-item__label">ìƒë‹´ ì§„í–‰</div>
                <div class="kpi-item__value">[[${progressCnt}]]ê±´</div>
                <div class="kpi-item__trend"></div>
              </div>
			  <div class="kpi-item">
			    <div class="kpi-item__label">ìƒë‹´ ì™„ë£Œ</div>
			    <div class="kpi-item__value">[[${completCnt}]]ê±´</div>
			    <div class="kpi-item__trend kpi-item__trend--down"></div>
			  </div>
              <div class="kpi-item">
                <div class="kpi-item__label">íŒë§¤ ì™„ë£Œ</div>
                <div class="kpi-item__value">[[${saleCnt}]]ëŒ€</div>
                <div class="kpi-item__trend"></div>
              </div>
            </div>
          </section>

		  <section class="card monthly-card" style="flex:1.2;">
		    <div class="card__header">
		      <h3 class="card__title">ì›”ê°„ íŒë§¤ëŸ‰</h3>
		      <span class="card__subtitle">ì‹¤ì‹œê°„ ë”œëŸ¬ë³„ ì›”ë³„ ì‹¤ì </span>
		    </div>
		    
			<div style="height: 580px; overflow: hidden; background: #fafbfc; border-radius: 8px;">
				<iframe
				  th:src="@{|http://localhost:8506/5core?dealerId=${dealerId}|}"
				  style="width:100%;height:580px;border:none;"
				  scrolling="no">
				</iframe>
			</div>
		  
        </aside>

        <!-- ë©”ì¸ íŒ¨ë„ -->
        <section class="main-panel">
          <div class="main-panel__header-row">
            <div>
              <h2 class="page-title">ê³ ê° ëª…ë‹¨</h2>
              <p class="page-subtitle">ì‹¤ì‹œê°„ ìƒë‹´ì‹ ì²­ í˜„í™© ë° VIP ê³ ê° ê´€ë¦¬</p>
            </div>
          </div>

          <!-- ê³ ê° ë¦¬ìŠ¤íŠ¸ -->
          <section class="card customer-section">
            <div class="card__header">
              <h3 class="card__title">ê³ ê° ë¦¬ìŠ¤íŠ¸</h3>
              <div class="card__subtitle"></div>
            </div>
            <div class="customer-list-wrapper">
              <table class="customer-table">
                <thead>
                  <tr>
                    <th>ê³ ê°</th>
                    <th>ì „í™”ë²ˆí˜¸</th>
                    <th>ì´ë©”ì¼</th>
                    <th>ë“±ê¸‰</th>
                    <th>ìƒíƒœ</th>
                    <th>êµ¬ë§¤ íšŸìˆ˜</th>
                  </tr>
                </thead>
                <tbody>
                  <tr th:each="customer, customerStat : ${counselingList}" class="customer-row">
                    <td>
                      <div class="customer-name-cell">
                        <div class="customer-avatar">
                          <span th:text="${#strings.substring(customer.customer.member.name,0,1)}"></span>
                        </div>
                        <span th:text="${customer.customer.member.name}"></span>
                      </div>
                    </td>
                    <td th:text="${customer.customer.member.phone}"></td>
                    <td th:text="${customer.customer.member.email}"></td>
                    <td>
                      <span th:if="${customer.customer.segment == 'vip'}" class="badge badge--vip">VIP</span>
                      <span th:if="${customer.customer.segment == 'ì¼ë°˜'}" class="badge badge--lead">ì¼ë°˜</span>
                    </td>
                    <td>
                      <span class="badge badge--pending" >[[${customer.status}]]</span>
                      <!--<span class="badge badge--lead" >ì‹œìŠ¹ ì˜ˆì•½</span>
                      <span class="badge badge--vip" >êµ¬ë§¤ ì™„ë£Œ</span>-->
                    </td>
                    <td>
                      <span class="customer-tag" >[[${customer.customer.purchaseCount}]]</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>

          <!-- ì˜¤ëŠ˜ì˜ ì—…ë¬´ ìš”ì•½ + ì›”ê°„ íŒë§¤ -->
          <div class="content__row" style="gap:16px; align-items:stretch;">
			
			<!-- ë‹¬ë ¥ -->
			<section class="card" style="flex:1.5;">
			  <div class="card__header">
			    <h3 class="card__title">ìƒë‹´ ì¼ì •</h3>
			    <span class="card__subtitle">ìƒë‹´ì§„í–‰ì¤‘ â€¢ ìƒë‹´ì™„ë£Œ ê³ ê°</span>
			  </div>
			  
			  <div class="calendar-container">
			    <div class="calendar-header">
			      <div class="calendar-title" id="calendarTitle">2025ë…„ 12ì›”</div>
			      <div class="calendar-nav">
			        <button class="calendar-nav-btn" id="prevMonth">â€¹</button>
			        <button class="calendar-nav-btn" id="todayBtn">ì˜¤ëŠ˜</button>
			        <button class="calendar-nav-btn" id="nextMonth">â€º</button>
			      </div>
			    </div>
			    
			    <div class="calendar-grid" id="calendarGrid">
			      <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
			    </div>
			  </div>
			</section>

			<section class="card monthly-card" style="flex:1.2;">
			  <div class="card__header">
			    <h3 class="card__title">ì´ ì°¨ì¢…ë³„ íŒë§¤ëŸ‰</h3>
			    <span class="card__subtitle">ì°¨ì¢…ë³„ íŒë§¤ ì¶”ì´ (ì‹¤ì‹œê°„)</span>
			  </div>
			  
			  <!-- KPI+íŒŒì´ ì™„ë²½ fit -->
			  <div style="height: 615px; overflow: hidden; background: #fafbfc; border-radius: 8px; padding: 8px;">
			    <iframe
			        th:src="@{|http://localhost:8503/5core?dealerId=${dealerId}|}"
			        style="width: 100%; height: 100%; border: none;"
			        scrolling="no"
			        frameborder="0">
			    </iframe>
			  </div>
			</section>
			
			
          </div>
        </section>
      </div>
    </div>
  </div>
  
  <script th:inline="javascript">
      window.counselingScheduleData = /*[[${counselingSchedule}]]*/ [];
  </script>

  <script>
  class Calendar {
      constructor(data) {
          this.data = data || [];
          this.currentYear = new Date().getFullYear();
          this.currentMonth = new Date().getMonth();
          this.init();
      }
	  
	  dateToYMD(date) {
	      const d = new Date(date.getFullYear(), date.getMonth(), date.getDate()); // ì‹œë¶„ì´ˆ 0ìœ¼ë¡œ
	      const y = d.getFullYear();
	      const m = (d.getMonth() + 1).toString().padStart(2, '0');
	      const day = d.getDate().toString().padStart(2, '0');
	      return `${y}-${m}-${day}`;  // "yyyy-MM-dd"
	  }

      init() {
          this.renderHeader();
          this.renderCalendar();
          this.attachEvents();
      }

      renderHeader() {
          const title = document.getElementById('calendarTitle');
          if (title) {
              const monthText = (this.currentMonth + 1).toString().padStart(2, '0');
              title.textContent = `${this.currentYear}ë…„ ${monthText}ì›”`;
          }
      }

      renderCalendar() {
          const grid = document.getElementById('calendarGrid');
          if (!grid) return;
          grid.innerHTML = '';

          // 1. ìš”ì¼ í—¤ë”
          ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '].forEach(day => {
              const header = document.createElement('div');
              header.className = 'calendar-day-header';
              header.textContent = day;
              grid.appendChild(header);
          });

          // 2. í˜„ì¬ ë…„/ì›” ê¸°ì¤€ìœ¼ë¡œ ìº˜ë¦°ë” ì‹œì‘ì¼ ê³„ì‚° (í•´ë‹¹ ì›” 1ì¼ì´ í¬í•¨ëœ ì£¼ì˜ ì¼ìš”ì¼)
          const firstDayOfMonth = new Date(this.currentYear, this.currentMonth, 1);
          const startDate = new Date(firstDayOfMonth);
          startDate.setDate(firstDayOfMonth.getDate() - firstDayOfMonth.getDay());

          // 3. 6ì£¼(42ì¹¸) ì±„ìš°ê¸°
          for (let i = 0; i < 42; i++) {
              const date = new Date(startDate);
              date.setDate(startDate.getDate() + i);

              const dayCell = document.createElement('div');
              dayCell.className = 'calendar-day';

              // ë‹¤ë¥¸ ë‹¬ ë‚ ì§œëŠ” ì—°í•œ íšŒìƒ‰
              if (date.getMonth() !== this.currentMonth) {
                  dayCell.classList.add('other-month');
              }

              // ì˜¤ëŠ˜ ë‚ ì§œ íŒŒë€ìƒ‰
              if (this.isToday(date)) {
                  dayCell.classList.add('today');
              }

              dayCell.innerHTML = `
                  <div class="calendar-day-number">${date.getDate()}</div>
                  <div class="calendar-events">${this.getDayEvents(date)}</div>
              `;

              dayCell.onclick = () => this.showDayDetail(date);
              grid.appendChild(dayCell);
          }
      }

	  getDayEvents(date) {
	      const dayStr = this.dateToYMD(date);
	      const events = this.data.filter(item =>
	          item.counselingDate === dayStr &&
	          (item.status === 'ìƒë‹´ì§„í–‰ì¤‘' || item.status === 'ìƒë‹´ì™„ë£Œ')
	      );

	      if (events.length === 0) {
	          return '<div class="calendar-event empty">ìƒë‹´ì—†ìŒ</div>';
	      }

	      return events
	          .slice(0, 2)
	          .map(event => `
	              <div class="calendar-event ${event.status === 'ìƒë‹´ì™„ë£Œ' ? 'completed' : 'progress'}">
	                  ${event.customerName}
	              </div>
	          `).join('') +
	          (events.length > 2 ? `<div class="calendar-event">+${events.length - 2}</div>` : '');
	  }

      isToday(date) {
          const today = new Date();
          return date.toDateString() === today.toDateString();
      }

	  showDayDetail(date) {
	      const dayStr = this.dateToYMD(date);
	      const events = this.data.filter(item =>
	          item.counselingDate === dayStr &&
	          (item.status === 'ìƒë‹´ì§„í–‰ì¤‘' || item.status === 'ìƒë‹´ì™„ë£Œ')
	      );

	      if (events.length === 0) {
	          alert(`${date.toLocaleDateString('ko-KR')} ìƒë‹´ì—†ìŒ`);
	          return;
	      }

	      const details = events.map(e =>
	          `ğŸ‘¤ ${e.customerName} (${e.phone})\nìƒíƒœ: ${e.status}`
	      ).join('\n\n');
	      alert(`ğŸ“… ${date.toLocaleDateString('ko-KR')} (${events.length}ê±´)\n\n${details}`);
	  }

      prevMonth() {
          this.currentMonth--;
          if (this.currentMonth < 0) {
              this.currentMonth = 11;
              this.currentYear--;
          }
          this.render();
      }

      nextMonth() {
          this.currentMonth++;
          if (this.currentMonth > 11) {
              this.currentMonth = 0;
              this.currentYear++;
          }
          this.render();
      }

      goToday() {
          const today = new Date();
          this.currentYear = today.getFullYear();
          this.currentMonth = today.getMonth();
          this.render();
      }

      render() {
          this.renderHeader();
          this.renderCalendar();
      }

      attachEvents() {
          const prevBtn = document.getElementById('prevMonth');
          const nextBtn = document.getElementById('nextMonth');
          const todayBtn = document.getElementById('todayBtn');

          if (prevBtn) prevBtn.onclick = () => this.prevMonth();
          if (nextBtn) nextBtn.onclick = () => this.nextMonth();
          if (todayBtn) todayBtn.onclick = () => this.goToday();
      }
  }

  // ì´ˆê¸°í™”
  document.addEventListener('DOMContentLoaded', function() {
      let data = window.counselingScheduleData || [];
      data = data.filter(item =>
          item && item.counselingDate &&
          (item.status === 'ìƒë‹´ì§„í–‰ì¤‘' || item.status === 'ìƒë‹´ì™„ë£Œ')
      );
      new Calendar(data);
  });
  </script>



</body>

</html>