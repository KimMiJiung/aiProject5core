<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>회원수정 - HYUNDAI CRM</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      color: #111827;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    /* 상단/하단 바 (링크 교체용) */
    .page-header,
    .page-footer {
      height: 46px;
      background: #000000;
      color: #ffffff;
      display: flex;
      align-items: center;
      padding: 0 20px;
      font-size: 14px;
      flex-shrink: 0;
    }

    .page-header__title {
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    /* 전체 레이아웃 */
    .layout {
      flex: 1;
      display: flex;
      justify-content: center;
	  margin: 30px 0;
    }

    .shell {
      width: 100%;
      max-width: 1200px;
      background: #ffffff;
      border-radius: 14px;
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.12);
      display: flex;
      overflow: hidden;
      min-height: 520px;
    }

    /* 좌측 메뉴 */
    .sidebar {
      width: 250px;
      background: linear-gradient(180deg, #0d47a1 0%, #093272 100%);
      color: #eef3ff;
      padding: 24px 18px;
      display: flex;
      flex-direction: column;
    }

    .sidebar__section-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 18px;
    }

    .sidebar__menu {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 12px;
    }

    .sidebar__item {
      border-radius: 9px;
      overflow: hidden;
    }

    .sidebar__link {
      display: block;
      padding: 10px 12px;
      font-size: 14px;
      color: #e5ecff;
      opacity: 0.9;
      transition: background 0.18s ease, opacity 0.18s ease, transform 0.1s ease;
      position: relative;
    }

    .sidebar__link::before {
      content: "";
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 3px;
      height: 0;
      background: #ffffff;
      border-radius: 999px;
      transition: height 0.18s ease;
    }

    .sidebar__link:hover {
      background: rgba(255, 255, 255, 0.16);
      opacity: 1;
      transform: translateY(-1px);
    }

    .sidebar__link--active {
      background: #ffffff;
      color: #0d47a1;
      font-weight: 600;
      opacity: 1;
    }

    .sidebar__link--active::before {
      height: 70%;
    }

    .sidebar__caption {
      margin-top: auto;
      font-size: 11px;
      opacity: 0.7;
    }

    /* 메인 영역 */
    .main {
      flex: 1;
      padding: 26px 30px 26px 26px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      background: radial-gradient(circle at top left, #e3eefc 0, transparent 55%);
    }

    .main__header {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      gap: 12px;
    }

    .main__title-block {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .page-title {
      font-size: 22px;
      font-weight: 700;
      color: #0d47a1;
    }

    .page-subtitle {
      font-size: 13px;
      color: #6b7280;
    }

    .chip-current {
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 11px;
      border: 1px solid #0d47a1;
      color: #0d47a1;
      background: #e3eefc;
      font-weight: 600;
      white-space: nowrap;
    }

    /* 폼 카드 */
    .card {
      background: #ffffff;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 22px 24px 24px;
      box-shadow: 0 6px 16px rgba(15, 23, 42, 0.04);
    }

    .card__title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 4px;
      color: #111827;
    }

    .card__subtitle {
      font-size: 12px;
      color: #6b7280;
      margin-bottom: 18px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 16px 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .form-label {
      font-size: 13px;
      font-weight: 600;
      color: #374151;
    }

    .form-label span.required {
      color: #ef4444;
      margin-left: 2px;
    }

    .form-input {
      padding: 9px 11px;
      border-radius: 8px;
      border: 1px solid #cbd5e1;
      font-size: 13px;
      color: #111827;
      background: #ffffff;
      transition: border-color 0.16s ease, box-shadow 0.16s ease;
    }

    .form-input:focus {
      outline: none;
      border-color: #0d47a1;
      box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.15);
    }

    .form-input[readonly],
    .form-input[disabled] {
      background: #f3f4f6;
      color: #6b7280;
      cursor: default;
      box-shadow: none;
    }

    /* 성별 */
    .gender-group {
      display: flex;
      gap: 12px;
      font-size: 9px;
      color: #374151;
      margin-top: 3px;
	  padding: 4px 0;
    }

    .gender-option input {
      margin-right: 5px;
    }

    /* 주소 2칸 병합 */
    .form-group--full {
      grid-column: 1 / -1;
    }

    .address-row {
      display: grid;
      grid-template-columns: 140px minmax(0.5fr,0.5fr);
      gap: 10px;
    }

    .helper-text {
      font-size: 11px;
      color: #9ca3af;
    }

    /* 버튼 영역 */
    .form-actions {
      margin-top: 20px;
      display: flex;
      justify-content: flex-end;
      gap: 8px;
    }

    .btn {
      padding: 9px 16px;
      border-radius: 999px;
      font-size: 13px;
      border: 1px solid transparent;
      cursor: pointer;
      transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease,
        transform 0.08s ease, box-shadow 0.16s ease;
    }

    .btn--ghost {
      background: #ffffff;
      color: #374151;
      border-color: #d1d5db;
    }

    .btn--ghost:hover {
      background: #f3f4f6;
    }

    .btn--primary {
      background: #0d47a1;
      color: #ffffff;
      box-shadow: 0 6px 12px rgba(15, 23, 42, 0.18);
    }

    .btn--primary:hover {
      background: #0b3b86;
      transform: translateY(-1px);
      box-shadow: 0 9px 18px rgba(15, 23, 42, 0.24);
    }
	
	.addressBtn {
	margin-top: 20px;
	display: flex;
	justify-content: flex-start;
	gap: 8px;
	}
	
	.radioBox {
	    display: inline-block;
	}
	.radioBox > label {
	    display: inline-block; width: 100px; border: 1px solid #cbd5e1; border-radius: 10px;
	}
	input[name=gender], input[name=foreigner] {
	    display: none;
	}
	.radio_check {
	    font-size: 1.5em; cursor: pointer; text-align: center;
		padding: 2px 0;
	}
	input[name=gender]:checked + label, input[name=foreigner]:checked + label {
	    color: #fff; border: 1px solid #0d47a1; background-color: #0d47a1;
	}

    /* 반응형 */
    @media (max-width: 900px) {
      .shell {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        flex-direction: row;
        align-items: center;
        padding: 16px 14px;
        gap: 16px;
      }

      .sidebar__section-title {
        margin-bottom: 0;
      }

      .sidebar__menu {
        flex-direction: row;
        gap: 6px;
        overflow-x: auto;
      }

      .sidebar__caption {
        display: none;
      }

      .main {
        padding: 18px 18px 22px;
      }
    }

    @media (max-width: 720px) {
      .form-grid {
        grid-template-columns: 1fr;
      }

      .address-row {
        grid-template-columns: 1fr;
      }
	  
    }
  </style>
</head>
<body>
	<!-- 헤더 -->
	<th:block th:replace="~{top}"></th:block>

  <div class="layout">
    <div class="shell">
      <!-- 좌측 메뉴 -->
      <aside class="sidebar" aria-label="마이페이지 메뉴">
        <div class="sidebar__section-title">마이페이지</div>
        <ul class="sidebar__menu">
		  <li class="sidebar__item" th:if="${member.role == member.role.CUSTOMER}">
		    <a th:href="@{|/counseling/applyList/${#authentication.getPrincipal().getUsername()}|}" class="sidebar__link">상담 목록</a>
		  </li>
          <li class="sidebar__item">
            <a th:href="@{|/member/update/${#authentication.getPrincipal().getUsername()}|}" class="sidebar__link sidebar__link--active">회원수정</a>
          </li>
          <li class="sidebar__item" th:if="${member.role == member.role.CUSTOMER}">
            <a th:href="@{/sale/list}" class="sidebar__link">구매 내역</a>
          </li>
        </ul>
        <div class="sidebar__caption">로그인한 계정 정보를 수정할 수 있습니다.</div>
      </aside>

      <!-- 메인 콘텐츠 -->
      <main class="main" aria-label="회원정보 수정">
        <div class="main__header">
          <div class="main__title-block">
            <h1 class="page-title">회원 정보 수정</h1>
            <p class="page-subtitle">아이디 및 기본정보는 변경할 수 없으며, 비밀번호와 연락처 · 이메일 · 주소만 수정 가능합니다.</p>
          </div>
          <span class="chip-current">현재 페이지 · 회원수정</span>
        </div>

        <section class="card" aria-label="회원 정보 수정 폼">
          <h2 class="card__title">기본 정보</h2>
          <p class="card__subtitle">필수 항목을 확인 후 정보를 수정해 주세요.</p>

          <form th:object="${member}" th:action="@{/member/update}" method="post">
			<input type="hidden" th:field="*{role}">
            <div class="form-grid">
              <div class="form-group">
                <label for="memberId" class="form-label">아이디</label>
                <input id="memberId" name="memberId" type="text" class="form-input" th:field="*{memberId}" readonly />
              </div>

              <div class="form-group">
                <label for="name" class="form-label">이름</label>
                <input id="name" name="name" type="text" class="form-input" th:field="*{name}" readonly />
              </div>

              <div class="form-group">
                <label class="form-label">성별</label>
				<div class="gender-group">
				    <div class="radioBox"><input type="radio" name="gender" value="남성" id="gender1" th:checked="*{gender == '남성'}"><label for="gender1" class="radio_check">남성</label></div>
				    <div class="radioBox"><input type="radio" name="gender" value="여성" id="gender2" th:checked="*{gender == '여성'}"><label for="gender2" class="radio_check">여성</label></div>
					<p class="helper-text" th:errors="*{gender}"></p>
				</div>
              </div>

              <div class="form-group">
                <label for="phone" class="form-label">연락처<span class="required">*</span></label>
                <input id="phone" name="phone" type="tel" class="form-input" th:field="*{phone}"/>
				<p class="helper-text" th:errors="*{phone}"></p>
              </div>

              <div class="form-group">
                <label for="email" class="form-label">이메일<span class="required">*</span></label>
                <input id="email" name="email" type="email" class="form-input" th:field="*{email}"/>
				<p class="helper-text" th:errors="*{email}"></p>
              </div>
			  
			  <div class="form-group">
			    <label for="zip" class="form-label">국가명</label>
			    <select name="address.country" class="form-input" th:field="*{address.country}">
			    	<option value="한국">한국</option>
			    	<option value="일본">일본</option>
			    	<option value="중국">중국</option>
			    	<option value="미국">미국</option>
			    	<option value="영국">영국</option>
			    	<option value="프랑스">프랑스</option>
			    </select>
			    <p class="helper-text" th:errors="*{address.country}"></p>
			  </div>

			  <div class="form-group">
			    <label for="zip" class="form-label">우편번호</label>
			    <input type="text" name="address.zipcode" class="form-input" id="zipcode" th:field="*{address.zipcode}" readonly>
			  </div>

			  <div class="addressBtn">
			    <a th:href="|javascript:searchAddress()|" class="btn btn--ghost" role="button">주소검색</a>
			  </div>

			  <div class="form-group form-group--full">
			    <label class="form-label">주소</label>
			    <div class="address-row">
			  	<input type="text" name="address.basicAddress" class="form-input" id="basicAddress" th:field="*{address.basicAddress}" readonly>
			      <input type="text" name="address.detailAddress" class="form-input" th:field="*{address.detailAddress}">
			    </div>
			    <p class="helper-text" th:errors="*{address.basicAddress}"></p>
			    <p class="helper-text" th:errors="*{address.detailAddress}"></p>
			  </div>

              <div class="form-group">
                <label for="password" class="form-label">새 비밀번호<span class="required">*</span></label>
                <input id="password" name="password" type="password" class="form-input" />
                <p class="helper-text" th:errors="*{password}"></p>
              </div>

              <div class="form-group">
                <label for="password2" class="form-label">비밀번호 확인<span class="required">*</span></label>
                <input id="password2" name="password2" type="password" class="form-input" />
				<p class="helper-text" th:errors="*{password2}"></p>
              </div>
            </div>

            <div class="form-actions">
              <a th:href="|javascript:deleteMember('*{memberId}')|" type="button" class="btn btn--ghost">삭제</a>
              <button type="submit" class="btn btn--primary">정보 수정하기</button>
            </div>
          </form>
        </section>
      </main>
    </div>
  </div>

  <!--푸터 -->
  <th:block th:replace="~{bottom}"></th:block>
  
</body>
</html>
<script>
	function searchAddress() {
		new daum.Postcode({
	        oncomplete: function(data) {
	            document.getElementById("zipcode").value = data.zonecode;
				document.getElementById("basicAddress").value = data.address;
	        }
	    }).open();
	}

	
	// 회원탈퇴
	function deleteMember(memberId) { 
		if(confirm("정말 회원을 탈퇴하겠습니까?")) {
			location.href = "/5core/member/delete/" + memberId;
		}
	}
</script>
